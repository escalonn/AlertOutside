@model LocationAlert.Client.Models.Account

@{
    ViewData["Title"] = "My Google Maps Demo";
}

@*https://developers.google.com/maps/documentation/javascript/examples/drawing-tools*@

<h3>Location Regions</h3>


<div id="map" style="height: 400px; width: 75%;">

    @section Scripts {
        <script>
            var regions = [];

            function initMap() {
                var uluru = { lat: 39.952584, lng: -75.165222 };
                var map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 6,
                    center: uluru
                });
                var marker = new google.maps.Marker({
                    position: uluru,
                    map: map,
                    editable: true
                });

                var drawingManager = new google.maps.drawing.DrawingManager({
                    drawingMode: google.maps.drawing.OverlayType.MARKER,
                    drawingControl: true,
                    drawingControlOptions: {
                        position: google.maps.ControlPosition.TOP_CENTER,
                        drawingModes: ['circle']
                    },
                    markerOptions: { icon: 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png' },
                    circleOptions: {
                        fillColor: '#f45642',
                        fillOpacity: 0.5,
                        strokeWeight: 1,
                        clickable: false,
                        editable: true,
                        zIndex: 1
                    }
                });
                drawingManager.setMap(map);

                google.maps.event.addListener(drawingManager, 'circlecomplete', function (circle) {

                    if (regions.length >= 3)
                    {
                        circle.setMap(null);
                    }
                    else
                    {
                        circle.id = regions.length;
                        regions.push(circle);
                    }
                });
            }

            function saveRegions() {
                var i = 0;
                regions.forEach(function (element) {
                    //Serialize Jason (id,longitude,latitude,radius) and send to server (Jquey.Ajax?)

                    console.log(element.id);
                    console.log(element.center.lat());
                    console.log(element.center.lng());
                    console.log(element.radius);
                });
            }
        </script>
        <script async defer
                src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDqINRPfJaUcmFkhziYrl3KgMY3NYCG4uQ&libraries=drawing&callback=initMap">
        </script>
    }
</div>

<button onclick="saveRegions()">Save Regions </button>